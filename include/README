# ESP32 Sensor Project

[![PlatformIO Build Status](https://github.com/darthshadoww/esp32-sensor-project/actions/workflows/ci.yml/badge.svg)](https://github.com/darthshadoww/esp32-sensor-project/actions)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)

**A PlatformIO-based ESP32 project to read sensor data and publish via MQTT, with OTA update support.**

---

## Table of Contents

1. [Features](#features)
2. [Prerequisites](#prerequisites)
3. [Installation](#installation)
4. [Configuration](#configuration)
5. [Building & Uploading](#building--uploading)
6. [Usage](#usage)
7. [Project Structure](#project-structure)
8. [Testing](#testing)
9. [Contributing](#contributing)
10. [License](#license)

---

## Features

* ğŸ”‹ Reads data from attached sensors (e.g., temperature, humidity)
* ğŸŒ Connects to Wi-Fi and an MQTT broker
* ğŸ“¡ Publishes sensor readings to configurable MQTT topics
* ğŸ”„ Supports OTA (Over-The-Air) firmware updates via PlatformIO
* ğŸ”§ Simple configuration via `secrets.h`, keeping credentials out of source control

---

## Prerequisites

* ESP32 development board
* USB cable for power and USB uploads
* [PlatformIO Core](https://docs.platformio.org/) installed
* An MQTT broker (public or private)
* Optional: CLion with PlatformIO plugin or VS Code with PlatformIO extension

---

## Installation

1. **Clone the repository**

   ```bash
   git clone https://github.com/darthshadoww/esp32-sensor-project.git
   cd esp32-sensor-project
   ```

2. **Initialize (if needed)**

   ```bash
   git init
   git remote add origin https://github.com/darthshadoww/esp32-sensor-project.git
   git branch -M main
   git add .
   git commit -m "Initial commit"
   git push -u origin main
   ```

---

## Configuration

1. **Copy the example file**

   ```bash
   cp include/secrets.example.h include/secrets.h
   ```
2. **Edit `include/secrets.h`** with your credentials:

   ```cpp
   #pragma once

   // Wi-Fi settings
   #define WIFI_SSID    "your_ssid"
   #define WIFI_PASS    "your_password"

   // MQTT settings
   #define MQTT_SERVER  "broker.hivemq.com"
   #define MQTT_PORT    1883
   #define MQTT_USER    "mqtt_user"
   #define MQTT_PASS    "mqtt_pass"

   // OTA update
   #define OTA_PASSWORD "ota_update_password"
   ```
3. Make sure `include/secrets.h` is listed in `.gitignore` to avoid accidental commits.

---

## Building & Uploading

* **USB Upload** (connect ESP32 via USB):

  ```bash
  pio run --environment esp32dev --target upload
  ```

* **OTA Upload** (wireless):

  ```bash
  pio run --environment ota --target upload
  ```

---

## Usage

1. After flashing, the ESP32 will connect to your Wi-Fi network.
2. It will then connect to the configured MQTT broker.
3. Sensor readings are published periodically to topics such as:

   * `sensors/temperature`
   * `sensors/humidity`
4. Monitor logs in real time:

   ```bash
   pio device monitor --environment esp32dev
   ```

---

## Project Structure

```
â”œâ”€â”€ include/
â”‚   â”œâ”€â”€ secrets.example.h  # Example credentials template
â”‚   â””â”€â”€ secrets.h          # Your private credentials (ignored by Git)
â”œâ”€â”€ lib/                   # Custom libraries (optional)
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.cpp           # Main application
â”‚   â”œâ”€â”€ actuator.cpp/.h    # Actuator control module
â”‚   â”œâ”€â”€ network.cpp/.h     # Wi-Fi & MQTT connectivity module
â”‚   â””â”€â”€ sensor.cpp/.h      # Sensor reading & publishing module
â”œâ”€â”€ test/                  # Unit tests (PlatformIO/Unity)
â”œâ”€â”€ platformio.ini         # Build configuration
â”œâ”€â”€ .gitignore             # Ignore list
â””â”€â”€ README.md              # This file
```

---

## Testing

Run PlatformIOâ€™s Unity tests:

```bash
pio test --environment esp32dev
```

---

## Contributing

1. Fork the repo
2. Create a feature branch:

   ```bash
   git checkout -b feature/your-feature
   ```
3. Commit your changes:

   ```bash
   git commit -m "feat: add ..."
   ```
4. Push and open a Pull Request.

Please follow the existing code style and include tests for new features.

---

## License

This project is licensed under the MIT License. See [LICENSE](LICENSE) for details.
